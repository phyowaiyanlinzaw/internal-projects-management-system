<!--

    TODO :: CREATE MODAL TO SHOW PROJECT'S DEATILS WHEN CLICK ON EACH PROJECT

    TODO :: FORM TO CREATE PROJECT IN MODAL

 -->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <title>Internal Project Management</title>
        <meta content="width=device-width, initial-scale=1.0" name="viewport" />
        <meta
            name="keywords"
            content="project, management, project management, teamplaceholder project management"
        />
        <meta content name="description" />
        <meta name="author" content="teamplaceholder's project" />

        <!-- Favicon -->
        <!-- <link href="/images/favicon.ico" rel="icon"> -->

        <!-- Google Web Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />

        <!-- bootstrap icons -->
        <link rel="stylesheet" href="/font/bootstrap-icons.min.css" />

        <!-- Libraries Stylesheet -->
        <link
            href="/lib/owlcarousel/assets/owl.carousel.min.css"
            rel="stylesheet"
        />
        <link
            href="/lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="/lib/quill/quill.bubble.css" />
        <link rel="stylesheet" href="/lib/quill/quill.snow.css" />
        <link href="/css/bootstrap.min.css" rel="stylesheet" />

        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/gh/habibmhamadi/multi-select-tag/dist/css/multi-select-tag.css"
        />

        <link href="/css/daypilot.css" rel="stylesheet" type="text/css" />

        <!-- datepicker -->
        <link
            rel="stylesheet"
            type="text/css"
            href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.css"
        />

        <!-- Bootstrap Tables -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.18.2/bootstrap-table.min.css"
        />
        <!-- Template Stylesheet -->
        <link href="/css/style.css" rel="stylesheet" />

        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/tagify/4.2.0/tagify.css"
        />
        <link
            href="/css/virtual-select/virtual-select.min.css"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="/css/bootstrap.min.css" />

        <link
            href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"
            rel="stylesheet"
        />
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.15.5/dist/sweetalert2.min.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/sweetalert2@10.15.5/dist/sweetalert2.min.css"
            rel="stylesheet"
        />

        <style>
            #deliverable-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }

            #deliverable-table th, #deliverable-table td {
                border: 1px solid #dddddd;
                text-align: left;
                padding: 8px;
            }

            #deliverable-table th {
                background-color: #f2f2f2;
            }
        </style>
        <script src="/js/fontawesome.js"></script>

        <!-- jquery -->
        <script src="/js/jquery.3.7.1.min.js"></script>

        <!-- datable table -->
        <script src="/js/databales.min.js"></script>
        <script src="/js/logout-modal.js"></script>

        <!-- bootstrap -->
        <script src="/js/bootstrap.bundle.min.js"></script>
        <!-- javascript libraries -->
        <script src="/lib/chart/chart.min.js" defer></script>
        <script src="/lib/easing/easing.min.js" defer></script>
        <script src="/lib/waypoints/waypoints.min.js" defer></script>
        <script src="/lib/owlcarousel/owl.carousel.min.js" defer></script>
        <script src="/lib/tempusdominus/js/moment.min.js" defer></script>
        <script
            src="/lib/tempusdominus/js/moment-timezone.min.js"
            defer
        ></script>
        <script
            src="/lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"
            defer
        ></script>
        <script src="/lib/quill/quill.min.js" defer></script>
        <script src="/js/virtual-select/virtual-select.min.js" defer></script>

        <!-- Template Javascript -->
        <script src="/js/main.js" defer></script>
        <script src="/js/forprogresscircleiguess.js" defer></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/tagify/4.2.0/tagify.min.js"
            defer
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/@coreui/coreui@4.3.0/dist/js/coreui.bundle.min.js"
            integrity="sha384-Iqk8EE7ao72xAVBuuQTEwrU5N2IdvpJER5ZzM6LxwcXHqj2WstttaOvopXziv0nU"
            crossorigin="anonymous"
            defer
        ></script>
        <script src="/js/custome.js" defer></script>
        <script src="/js/getDataForProject.js" type="module" async></script>
        <!--        <script src="/js/currentLoginUser.js" type="module" async></script>-->
        <script type="module" defer>
            $(document).ready(function () {
                setupLogoutConfirmation();
            });

            import {
                formatDateFromMilliseconds,
                MONTH_NAMES,
                calculateDuration,
                calculateEndDate,
            } from "/js/time.js";

            import { sendData, getData } from "/js/api-function.js";

            import {
                getArchitecturelist,
                getClientList,
                getDeliverableTypeList,
            } from "/js/getDataForProject.js";

            import { getUser } from "/js/currentLoginUser.js";

            const languageList = {
                "c#": "/images/languages/c#.png",
                "c++": "/images/languages/c++.png",
                "html": "/images/languages/html.png",
                "java": "/images/languages/java.png",
                "js": "/images/languages/js.png",
                "php": "/images/languages/php.png",
                "python": "/images/languages/python.png",
                "ruby": "/images/languages/ruby.png",
                "SQL": "/images/languages/SQL.png",
                "css" : "/images/languages/css.png",
                "typescript": "/images/languages/typescript.png"
            }

            console.log(await getUser());

            const loginUser = await getUser();

            if (loginUser.currentUser.role === "PROJECT_MANAGER") {
                const addDepartmentButton = document.querySelector(
                    `button[data-bs-target="#add-department-modal"]`
                );
                if (addDepartmentButton) {
                    addDepartmentButton.classList.remove("d-none");
                }
            }

            const clientList = await getClientList();
            console.log(clientList);
            const clientSelect = document.querySelector("select[id='client']");
            clientList.forEach((client) => {
                const option = document.createElement("option");
                option.value = JSON.stringify(client);
                option.textContent = client.name;
                clientSelect.append(option);
            });

            function initializeTagify(input, whiteList) {
                return new Tagify(input, {
                    whitelist: whiteList.map((item) => item.tech_name),
                    dropdown: {
                        consoleLog: true,
                        classname: "tags-look",
                        enabled: 0,
                        closeOnSelect: false,
                    },
                });
            }

            let deliTypeList = await getDeliverableTypeList();

            getDeliverableTypeList().then((deliType) => {
                const deliTypeSelect = document.querySelector("#deliverable");
                console.log(deliType);
                const a = new Tagify(deliTypeSelect, {
                    whitelist: deliType.map((item) => item.type),
                    dropdown: {
                        consoleLog: true,
                        classname: "tags-look",
                        enabled: 0,
                        closeOnSelect: false,
                    },
                });
                $("#validation-form").submit(function (event) {
                    const deli =
                        this.querySelector("#deliverable").value === ""
                            ? []
                            : JSON.parse(
                                  this.querySelector("#deliverable").value
                              );
                    if (deli.length !== 0) {
                        const whitelist = a.settings.whitelist;
                        deli.forEach((item) => {
                            if (!whitelist.includes(item.value)) {
                                whitelist.push(item.value);
                            }
                        });
                    }
                    console.log(a.settings.whitelist);
                });
            });

            let arcccList = await getArchitecturelist();

            getArchitecturelist()
                .then((architectureList) => {
                    const inputElement = document.querySelector(
                        'input[name="architectures"]'
                    );
                    const a = initializeTagify(inputElement, architectureList);
                    $("#validation-form").submit(function (event) {
                        const arch =
                            inputElement.value === ""
                                ? []
                                : JSON.parse(inputElement.value);
                        if (arch.length !== 0) {
                            const whitelist = a.settings.whitelist;
                            arch.forEach((item) => {
                                if (!whitelist.includes(item.value)) {
                                    whitelist.push(item.value);
                                }
                            });
                        }
                        console.log(a.settings.whitelist);
                    });
                })
                .catch((error) => {
                    console.log("Error:", error);
                });

            const toolbaroptions = [
                // Test-style
                ["bold", "italic", "underline"],

                // Bullet points style...
                [{ list: "ordered" }, { list: "bullet" }],

                // Indentation...
                [{ indent: "+1" }, { indent: "-1" }],

                // Alignment
                [{ align: [] }],

                // Header for test, e.g., h1, h2...
                [{ header: [1, 2, 3, 4, 5, 6, false] }],

                // Adding image, link, video, or formula
                ["link"],
            ];
            //Save Review


            // SAVE CLIENT
            document
                .querySelector("#client-form")
                .addEventListener("submit", function (e) {
                    e.preventDefault();

                    let name = document.querySelector("#client-name").value;
                    let email = document.querySelector("#client-email").value;
                    let phone = document.querySelector("#client-phone").value;

                    if (name === "" || email === "" || phone === "") {
                        alert("client form empty");
                        return;
                    }

                    const clientDto = {
                        name: name,
                        email: email,
                        phone: phone,
                    };

                    console.log(clientDto)

                    $.ajax({
                      method: "POST",
                        url: "/api/client/save",
                        data : JSON.stringify(clientDto),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (response) {
                            console.log(response);
                            const option = document.createElement("option");
                            option.value = JSON.stringify(response);
                            option.textContent = response.name;
                            clientSelect.append(option);
                            document.querySelector("#client-name").value = "";
                            document.querySelector("#client-email").value = "";
                            document.querySelector("#client-phone").value = "";
                        },
                        error: function (error) {
                            console.error("Error in Url : /api/cleient/save ", error);
                        },
                    })
                });

            const projectObjectiveEditor =
                document.querySelector(".quill-editor-full");

            const editProjectObjectiveEitor = document.querySelector(
                "#edit-project-objective"
            );

            const editObjectiveEditor = new Quill(editProjectObjectiveEitor, {
                modules: {
                    toolbar: toolbaroptions,
                },
                theme: "snow",
            });

            const addObjectiveEditor = new Quill(projectObjectiveEditor, {
                modules: {
                    toolbar: toolbaroptions,
                },
                theme: "snow",
            });

            async function getAllProjects() {
                switch (loginUser.currentUser.role) {
                    case "PROJECT_MANAGER":
                        console.log("project manager");
                        return await getData(
                            `/api/project/list/${loginUser.currentUser.role}/${loginUser.currentUser.id}`
                        );
                        break;

                    case "DEPARTMENT_HEAD":
                        console.log("department head");
                        return await getData(
                            `/api/project/list/${loginUser.currentUser.role}/${loginUser.currentUser.id}`
                        );
                        break;
                    case "EMPLOYEE":
                    case "CONTRACT":
                    case "FOC":
                        console.log("one of the memeber");
                        return await getData(
                            `/api/project/list/MEMBER/${loginUser.currentUser.id}`
                        );
                    default:
                        console.log("pmo or sdqc");
                        return await getData(`/api/project/list`);
                }
            }

            const motherContainer = document.querySelector("#sort-container");

            const fragment = document.createDocumentFragment();

            let pList = await getAllProjects();

            let departmentProjectId;

            if (
                loginUser.currentUser.role == "PMO" ||
                loginUser.currentUser.role == "SDQC"
            ) {
                departmentProjectId = await getData(
                    "/api/project/list/for/pmoandsdqc"
                );
            }

            if (departmentProjectId) {
                console.log(
                    "proejct id mapped by department id",
                    departmentProjectId
                );
            }

            console.log(pList);

            const dPList = await getData("/api/project/list");

            dPList.forEach((item) => {
                const option = document.createElement("option");
                option.value = item.id;
                option.textContent = item.name;
                document
                    .getElementById("department-filter")
                    .appendChild(option);
            });

            function updateSpanValues(amountDto) {
                // Define a mapping between keys in amountDto and the corresponding span element IDs
                const keyToSpanId = {
                    basic_design: "basic-design-count",
                    detail_design: "dd",
                    coding: "ing",
                    unit_testing: "ut",
                    integrated_testing: "it",
                };

                // Iterate through amountDto and update the span elements accordingly
                for (const key in amountDto) {
                    if (amountDto.hasOwnProperty(key)) {
                        const value = amountDto[key];
                        const spanId = keyToSpanId[key];

                        if (spanId) {
                            const spanElement = document.getElementById(spanId);
                            if (spanElement) {
                                spanElement.innerText = value;
                            }
                        }
                    }
                }
            }

            function updateListItems(a) {
                const list = document.querySelector(".list-group");
                const items = list.querySelectorAll(".list-group-item");

                // Define a mapping between keys in systemOutLineDto and the corresponding list item index
                const keyToIndex = {
                    analysis: 0,
                    sys_design: 1,
                    coding: 2,
                    testing: 3,
                    deploy: 4,
                    maintenance: 5,
                    document: 6,
                };

                // Iterate through systemOutLineDto and update the list items accordingly
                for (const key in a) {
                    if (a.hasOwnProperty(key)) {
                        const value = a[key];
                        const index = keyToIndex[key];

                        if (index !== undefined && items[index]) {
                            if (value) {
                                // Add the <i> element with the checkmark
                                items[
                                    index
                                ].innerHTML = `${key}<i class="bi bi-check2-all text-success fs-4"></i>`;
                            } else {
                                // Remove the <i> element
                                items[index].innerHTML = key;
                            }
                        }
                    }
                }
            }

            //____________________________________current project

            for (let i = 0; i < pList.length; i++) {
                let currentProject = pList[i];

                const div = document.createElement("div");
                div.classList.add(
                    "p-md-3",
                    "p-sm-2",
                    "active-card",
                    "mt-3",
                    "mt-md-0",
                    "mt-lg-0",
                    "mt-xl-0"
                );
                div.id = `project-${currentProject.id}`;

                const card = document.createElement("div");
                card.classList.add("card", "border-success");

                const cardHeader = document.createElement("div");
                cardHeader.classList.add("card-header");

                const dFlexContainer = document.createElement("div");
                dFlexContainer.classList.add("d-flex", "flex-column");

                const h2 = document.createElement("h2");
                h2.classList.add(
                    "card-title",
                    "text-center",
                    "text-primary",
                    "modal-detail-title"
                );
                h2.innerText = currentProject.name;

                const dFlexBetween = document.createElement("div");
                dFlexBetween.classList.add("d-flex", "justify-content-between");

                const dFlexInner = document.createElement("div");
                dFlexInner.classList.add("d-flex");

                const img = document.createElement("img");
                img.src = `/images/avatars/pm_avatar.svg`;
                img.classList.add(
                    "img-fluid",
                    "rounded-circle",
                    "d-none",
                    "d-md-block",
                    "d-sm-block"
                );
                img.style.width = "40px";
                img.alt = "Profile Image";

                const h5 = document.createElement("h5");
                h5.classList.add(
                    "card-text",
                    "text-center",
                    "text-align-center",
                    "my-auto",
                    "fst-italic",
                    "fs-6",
                    "ms-2"
                );

                h5.innerText = currentProject.userDto.name;

                const a = document.createElement("a");
                a.href = "#";
                a.id = currentProject.id;
                a.classList.add(
                    "btn",
                    "btn-white",
                    "text-secondary",
                    "link-shadow"
                );
                a.setAttribute("data-bs-toggle", "modal");
                a.setAttribute("data-bs-target", "#project-details");
                a.innerText = "See More";

                // Create and append the progress-related elements
                const cardBody = document.createElement("div");
                cardBody.classList.add(
                    "card-body",
                    "position-relative",
                    "mx-auto"
                );

                const progressTitle = document.createElement("p");
                progressTitle.classList.add(
                    "card-title",
                    "text-center",
                    "fs-6",
                    "mb-1"
                );
                progressTitle.innerText = "progress";

                const progressCircle = document.createElement("div");
                progressCircle.id = `circle-progress-${currentProject.id}`;
                progressCircle.classList.add(
                    "circle-progress",
                    "rounded-circle"
                );
                progressCircle.setAttribute("data-min-value", "0");
                progressCircle.setAttribute("data-max-value", "100");
                progressCircle.setAttribute(
                    "data-value",
                    currentProject.totalTask == 0
                        ? (
                              (currentProject.completeTaskCount /
                                  currentProject.totalTaskCount) *
                              100
                          ).toString()
                        : 0
                );
                progressCircle.setAttribute("data-type", "percent");

                dFlexInner.appendChild(img);
                dFlexInner.appendChild(h5);
                dFlexBetween.appendChild(dFlexInner);
                dFlexBetween.appendChild(a);
                dFlexContainer.appendChild(h2);
                dFlexContainer.appendChild(dFlexBetween);
                cardHeader.appendChild(dFlexContainer);
                card.appendChild(cardHeader);

                cardBody.appendChild(progressTitle);
                cardBody.appendChild(progressCircle);
                card.appendChild(cardBody);

                div.appendChild(card);
                fragment.appendChild(div);
            }

            motherContainer.appendChild(fragment);

            const detailMoal = document.querySelector("#project-details");

            function formmatDateFromMillisecondForEdit(milliseconds) {
                const date = new Date(milliseconds);

                // Get the year, month, and day from the Date object
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed, so add 1
                const day = String(date.getDate()).padStart(2, '0');

                // Create the formatted date string
                const formattedDate = year + '-' + month + '-' + day;

                return formattedDate;
            }

            const log = console.log;

            log(pList)

            motherContainer.addEventListener("click", async function (e) {
                let target = e.target;

                if (target.hasAttribute("data-bs-target")) {
                    let id = parseInt(target.getAttribute("id"));
                    let targetData = pList.find((a) => a.id == id);


                    document.querySelector(
                        "#project-detail-background"
                    ).innerText = targetData.background;
//------------------------architecture list start
                    document.querySelector("#architectures-list-in-edit").textContent = ''

                    targetData.architectureDto.forEach(a => {

                        const div = document.createElement("div");

                        div.classList.add("d-flex", "gap-2", "align-items-center", "justify-content-center");

                        const image = document.createElement("img");

                        image.style.width = "40px"

                        if (languageList[a.tech_name]) {
                            image.setAttribute("src", languageList[a.tech_name]);
                        } else {
                            // Handle the case where the language is not found in the map
                            image.setAttribute("src", "/images/languages/default.png");
                        }

                        div.appendChild(image);

                        const p = document.createElement("p");
                        p.textContent = a.tech_name;
                        p.classList.add("fs-6", "fw-bold")
                        div.appendChild(p);

                        document.querySelector("#architectures-list-in-edit").appendChild(div);
                    })

                    //------------------------ architecture list end

                    //------------------------ deliverable list start
                    document.querySelector("#deliverable-type").textContent = ''
                   let deliverableId;
                    targetData.deliverableDto.forEach(a => {
                        const div = document.createElement("div");
                        div.classList.add("d-flex", "gap-2", "align-items-center", "justify-content-center");

                        deliverableId = a.id;
                        const input = document.createElement('input');
                        input.type = 'checkbox';


                        if (a.status) {
                            input.checked = false;
                        }

                        const p = document.createElement("p");
                        p.textContent = a.deliverableType.type;
                        console.log(a.status)
                        console.log(a.deliverableType.type)
                        p.classList.add("fs-6", "fw-bold");
                        div.appendChild(p);
                        div.appendChild(input)

                        document.querySelector("#deliverable-type").appendChild(div);
                    });

                    document.querySelector("#deliverable-type-form").addEventListener("submit", function (event) {
                        event.preventDefault();
                        targetData.deliverableDto.forEach(a => {
                            const checkbox = document.querySelector(`#checkbox-${a.deliverableType.id}`);

                            if (checkbox && checkbox.checked) {
                                a.status = true;
                            } else {
                                a.status = false;
                            }
                        });


                        console.log("delivv    "+deliverableId);
                        // Send the updated data to the server using fetch or any other method
                        // Example using fetch:
                        fetch(`/api/deliverable/update-status/${deliverableId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({deliverableDto: targetData.deliverableDto}),
                        })
                            .then(response => response.json())
                            .then(data => {
                                console.log('Status updated successfully:', data);
                            })
                            .catch(error => {
                                console.error('Error updating status:', error);
                            });
                    });

                    //------------------------ deliverable list end

                    document.querySelector("#project-detail-name").value =
                        targetData.name;

                    const objectiveQuill = new Quill(
                        "#show-project-objective",
                        {
                            modules: {
                                toolbar: false,
                            },
                            theme: "snow",
                        }
                    );

                    document.querySelector("#navigate-task").href = `/project/${targetData.id}`

                    document.querySelector("#current-edditing-projetc-id").value = targetData.id;

                    console.log(document.querySelector("#current-edditing-projetc-id").value)

                    objectiveQuill.enable(false);

                    objectiveQuill.clipboard.dangerouslyPasteHTML(
                        0,
                        targetData.objective
                    );

                    document.querySelector("#project-edit-duration").value =
                        targetData.duration;

                    document.querySelector("#start-date").value =
                        formmatDateFromMillisecondForEdit(targetData.start_date);

                    document.querySelector("#end-date-in-edit").value =
                        formatDateFromMilliseconds(targetData.end_date);

                    const phaseOptionList = document.querySelectorAll("#edit-project-phase option")

                    console.log(phaseOptionList)

                    phaseOptionList.forEach(a => {
                        if (a.value === targetData.current_phase) {
                            a.selected = true
                        }
                    })

                    editObjectiveEditor.clipboard.dangerouslyPasteHTML(
                        0,
                        targetData.objective
                    );

                    console.log(targetData);

                    updateListItems(targetData.systemOutLineDto);

                    updateSpanValues(targetData.amountDto);

                    let duration = calculateDuration(
                        targetData.start_date,
                        targetData.end_date
                    );
                    detailMoal.querySelector("#basic-design-count").innerText = targetData.amountDto.basic_design;
                    detailMoal.querySelector("#detail-design-count").innerText = targetData.amountDto.detail_design;
                    detailMoal.querySelector("#coding-count").innerText = targetData.amountDto.coding;
                    detailMoal.querySelector("#unit-testing-count").innerText = targetData.amountDto.unit_testing;
                    detailMoal.querySelector("#integrated-testing-count").innerText = targetData.amountDto.integrated_testing;

                    detailMoal.querySelector("#edit-basic-design-count").value = targetData.amountDto.basic_design;
                    detailMoal.querySelector("#edit-detail-design-count").value = targetData.amountDto.detail_design;
                    detailMoal.querySelector("#edit-coding-count").value = targetData.amountDto.coding;
                    detailMoal.querySelector("#edit-unit-testing-count").value = targetData.amountDto.unit_testing;
                    detailMoal.querySelector("#edit-integrated-testing-count").value = targetData.amountDto.integrated_testing;

                    detailMoal.querySelector(".modal-title").innerText =
                        targetData.name;
                    detailMoal.querySelector("#project-background").innerText =
                        targetData.background;
                    detailMoal.querySelector("#project-name").innerText =
                        targetData.name;
                    detailMoal.querySelector(
                        "#project-department-name"
                    ).innerHTML = targetData.departmentDto.name;

                    //Review
                    detailMoal.querySelector(
                        "#project-internal-review-count"
                    ).value = targetData.reviewDto.internal_review_count;
                    detailMoal.querySelector(
                        "#project-external-review-count"
                    ).value = targetData.reviewDto.external_review_count;
                    //______________________________________________

                    detailMoal.querySelector(
                        "#project-duration"
                    ).innerText = `${duration}`;
                    detailMoal.querySelector("#project-start-date").innerText =
                        formatDateFromMilliseconds(targetData.start_date);
                    detailMoal.querySelector("#project-end-date").innerText =
                        formatDateFromMilliseconds(targetData.end_date);
                    detailMoal.querySelector(
                        "#project-current-phase"
                    ).innerText = targetData.current_phase;


                    //_____________________________
                    detailMoal.querySelector(
                        "#client-email-address"
                    ).innerHTML = targetData.clientDto.email;
                    detailMoal.querySelector(
                        "#client-phone-contect"
                    ).innerHTML = targetData.clientDto.phone;
                    detailMoal.querySelector(
                        "#my-dear-customer-name"
                    ).innerHTML = targetData.clientDto.name;

                }

                //_____________________________________________
            });

            document.querySelector("#project-detail-edit-form").addEventListener("submit", function (e) {
                e.preventDefault()

                const project = {
                    id: parseInt(document.querySelector("#current-edditing-projetc-id").value),
                    name: document.querySelector("#project-detail-name").value,
                    duration: parseInt(document.querySelector("#project-edit-duration").value),
                    start_date: new Date(document.querySelector("#start-date").value).getTime(),
                    background: document.querySelector("#project-detail-background").value,
                    end_date: new Date(document.querySelector("#end-date-in-edit").value).getTime(),
                    current_phase: document.querySelector("#edit-project-phase").value,
                    objective: editObjectiveEditor.root.innerHTML
                }

                console.log(project)

                sendData("/api/project/update", "PUT", project)
                    .then((response) => {
                        console.log(response)
                    })
                    .then((message) => {
                        console.log(message);
                        alert("Project updated successfully");
                        location.reload();
                        e.currentTarget.submit();
                    })
            })

            document.querySelector("#update-amount-btn").addEventListener("click", function (e) {

                const projectId = parseInt(document.querySelector("#current-edditing-projetc-id").value)

                const amountDto = {
                    basic_design: parseInt(document.querySelector("#edit-basic-design-count").value),
                    detail_design: parseInt(document.querySelector("#edit-detail-design-count").value),
                    coding: parseInt(document.querySelector("#edit-coding-count").value),
                    unit_testing: parseInt(document.querySelector("#edit-unit-testing-count").value),
                    integrated_testing: parseInt(document.querySelector("#edit-integrated-testing-count").value)
                }

                sendData(`/api/project/update/amount/${projectId}`, "PUT", amountDto)
                    .then((response) => {
                        console.log(response)
                    })
                    .then((message) => {
                        console.log(message);
                        alert("Project updated successfully");
                        location.reload();
                        e.currentTarget.submit();
                    })
            })

            const sortProjectByDepartment = await getData(
                "/api/project/list/sort/by/department"
            );

            document
                .getElementById("department-filter")
                .addEventListener("change", function () {
                    const allDiv = motherContainer.children;
                    const selectedDepartmentId = this.value;

                    for (let i = 0; i < allDiv.length; i++) {
                        if (
                            sortProjectByDepartment[
                                selectedDepartmentId
                            ].includes(parseInt(allDiv[i].id.split("-")[1]))
                        ) {
                            allDiv[i].style.display = "block";
                        } else {
                            allDiv[i].style.display = "none";
                        }
                    }
                });

            const monthFilter = document.querySelector("#month-filter");
            const yearFilterSelect = document.getElementById("year-filter");

            document.querySelectorAll("select[action='filter']").forEach((a) =>
                a.addEventListener("input", function (e) {
                    const allData =
                        document.getElementById("sort-container").children;
                    const currentTime = monthFilter.value;
                    const yearValue = parseInt(yearFilterSelect.value);

                    const matchingProjects = pList.filter((a) => {
                        const projectDate = new Date(a.start_date);
                        const projectMonth = projectDate.getMonth();
                        const projectYear = projectDate.getFullYear();
                        return (
                            projectYear === yearValue &&
                            MONTH_NAMES[projectMonth] === currentTime
                        );
                    });

                    for (let i = 0; i < allData.length; i++) {
                        const divId = parseInt(
                            allData[i].getAttribute("id").split("-")[1]
                        );

                        if (
                            matchingProjects.some(
                                (project) => project.id === divId
                            )
                        ) {
                            allData[i].style.display = "block";
                        } else {
                            allData[i].style.display = "none";
                        }
                    }
                })
            );

            const currentYear = new Date().getFullYear();

            document
                .querySelector("#reset-btn")
                .addEventListener("click", function (e) {
                    let allData =
                        document.getElementById("sort-container").children;

                    for (let i = 0; i < allData.length; i++) {
                        allData[i].style.display = "block";
                    }
                    monthFilter.value = MONTH_NAMES[0];
                });

            console.log("error");

            let quillEditors = document.querySelectorAll(
                ".quill-editor-bubble"
            );

            // Initialize Quill for each selected element
            quillEditors.forEach(function (editor) {
                new Quill(editor, {
                    modules: {
                        toolbar: toolbaroptions,
                    },
                    theme: "snow",
                });
            });

            // function getData() {
            //     const userInput = quill.root.innerHTML;
            //     console.log(userInput);
            // }

            let minusButtons = document.querySelectorAll(".minus");
            let plusButtons = document.querySelectorAll(".plus");

            minusButtons.forEach(function (minusButton) {
                minusButton.addEventListener("click", function () {
                    let input = this.parentElement.querySelector("input");
                    let count = parseInt(input.value) - 1;
                    count = count < 0 ? 0 : count;
                    input.value = count;
                    console.log(input, count);
                    //input.dispatchEvent(new Event('change'));
                    return false;
                });
            });

            plusButtons.forEach(function (plusButton) {
                plusButton.addEventListener("click", function () {
                    let input = this.parentElement.querySelector("input");
                    input.value = parseInt(input.value) + 1;
                    //input.dispatchEvent(new Event('change'));
                    return false;
                });
            });

            let employeeList = loginUser.employees;

            console.log(employeeList);

            let empTagifyList = [];

            if (employeeList) {
                const showEmpList = employeeList.map((item) => {
                    console.log(item);
                    return {
                        label: item.name,
                        value: item.id,
                        alias: item.role.toLowerCase(),
                    };
                });
                empTagifyList = VirtualSelect.init({
                    ele: "#employee-list",
                    options: showEmpList,
                    multiple: true,
                    search: true,
                    searchByStartsWith: true,
                    popupPosition: null,
                    maxWidth: "100%",
                });
                console.log(empTagifyList);
            }

            $(document).ready(function () {
                document
                    .querySelector("#start_date")
                    .addEventListener("change", function () {
                        const projectDruation = document.querySelector(
                            "#project-add-duration"
                        ).value;

                        const projectEndDate = document.querySelector(
                            "#project-add-end-date"
                        );

                        const endDate = calculateEndDate(
                            new Date(this.value).getTime(),
                            projectDruation
                        );

                        projectEndDate.value = formatDateFromMilliseconds(
                            endDate.getTime()
                        );
                    });

                document.querySelector("#start-date").addEventListener("change", function () {
                        const projectDruation = document.querySelector(
                            "#project-edit-duration"
                        ).value;

                        const projectEndDate = document.querySelector(
                            "#end-date-in-edit"
                        );

                        const endDate = calculateEndDate(
                            new Date(this.value).getTime(),
                            projectDruation
                        );

                        projectEndDate.value = formatDateFromMilliseconds(
                            endDate.getTime()
                        );
                    });

                document
                    .querySelector("#project-add-duration")
                    .addEventListener("input", function () {
                        const projectStartDate =
                            document.querySelector("#start_date").value;

                        if (projectStartDate !== "") {
                            const projectEndDate = document.querySelector(
                                "#project-add-end-date"
                            );

                            // Calculate the end date only when there's a valid start date
                            const endDate = calculateEndDate(
                                new Date(projectStartDate).getTime(),
                                this.value
                            );

                            // Check if endDate is not NaN
                            if (!isNaN(endDate)) {
                                projectEndDate.value =
                                    formatDateFromMilliseconds(endDate);
                            }
                        }
                    });

                document.querySelector("#project-edit-duration").addEventListener("input", function () {
                        const projectStartDate =
                            document.querySelector("#start-date").value;

                        if (projectStartDate !== "") {
                            const projectEndDate = document.querySelector(
                                "#end-date-in-edit"
                            );

                            // Calculate the end date only when there's a valid start date
                            const endDate = calculateEndDate(
                                new Date(projectStartDate).getTime(),
                                this.value
                            );

                            // Check if endDate is not NaN
                            if (!isNaN(endDate)) {
                                projectEndDate.value =
                                    formatDateFromMilliseconds(endDate);
                            }
                        }
                    });

                $("#validation-form").submit(function (event) {
                    event.preventDefault(); // Prevent the form from submitting the traditional way

                    const projectName = $("#name").val();
                    const client = JSON.parse($("#client").val());
                    const startDate = new Date(
                        $("#start_date").val()
                    ).getTime();
                    const duration = +$("#project-add-duration").val();

                    const background = $("#background").val();
                    let architectures = $("#architectures").val();
                    const empList = empTagifyList.selectedValues;
                    console.log("architectures list : ", architectures);
                    const systemOutlines = sysSelect.selectedValues;
                    const deliverable = $("#deliverable").val();
                    const objective = addObjectiveEditor.root.innerHTML; // Assuming you're using a WYSIWYG editor like Quill
                    console.log(
                        projectName,
                        client,
                        startDate,
                        duration,
                        background,
                        architectures,
                        empList,
                        systemOutlines,
                        deliverable,
                        objective
                    );
                    if (
                        projectName === "" ||
                        client === "" ||
                        startDate === 0 ||
                        duration === 0 ||
                        background === "" ||
                        architectures === "" ||
                        systemOutlines === "" ||
                        deliverable === "" ||
                        objective === "<p><br></p>"
                    ) {
                        alert("Please fill all the fields");
                        return;
                    }

                    architectures = JSON.parse(architectures);

                    const arcList = architectures.map((ar) => {
                        const matchingObj = arcccList.find(
                            (arccObj) => arccObj.tech_name === ar.value
                        );
                        console.log(matchingObj);
                        return matchingObj
                            ? matchingObj
                            : { tech_name: ar.value };
                    });

                    const oldDeliTypeList = JSON.parse(deliverable);

                    const deliverTypeList = oldDeliTypeList.map((deli) => {
                        const matchingObj = deliTypeList.find(
                            (deliObj) => deliObj.type === deli.value
                        );
                        console.log(matchingObj);
                        return matchingObj ? matchingObj : { type: deli.value };
                    });
                    // You may want to add some form validation here before sending the data
                    console.log(objective);
                    console.log(architectures);
                    console.log(empList);
                    const project = {
                        name: projectName,
                        clientDto: client,
                        duration: duration,
                        start_date: startDate,
                        end_date: calculateEndDate(
                            startDate,
                            duration
                        ).getTime(),
                        background: background,
                        architectureDto: arcList,
                        systemOutLineDto: systemOutlines.reduce((acc, cur) => {
                            acc[cur] = true;
                            return acc;
                        }, {}),
                        current_phase: "PLANNING",
                        deliverableDto: deliverTypeList.map((item) => ({
                            deliverableType: { type: item.type },
                        })),
                        objective: objective,
                        amountDto: {
                            basic_design: 0,
                            detail_design: 0,
                            coding: 0,
                            unit_testing: 0,
                            integrated_testing: 0,
                        },
                        departmentDto: {
                            id: loginUser.currentUser.department.id,
                        },
                        userDto: {
                            id: loginUser.currentUser.id,
                        },
                        userDtos: empList.map((str) => ({ id: parseInt(str) })),
                    };
                    console.log(project);
                    //Perform the AJAX request
                    $.ajax({
                        url: "/api/project/save", // Replace with the actual URL for your project registration endpoint
                        type: "POST",
                        data: JSON.stringify(project),
                        dataType: "json",
                        contentType: "application/json; charset=utf-8",
                        success: async function (data) {
                            alert("Project registered successfully");
                            // Reset the form if needed
                            $("#validation-form")[0].reset();
                            console.log("this projce has benn saved", data);
                            // event.currentTarget.submit();
                            await getAllProjects();

                        },
                        error: function (data) {
                            alert("Error registering project");
                            // event.currentTarget.submit();
                        },
                    });
                });
            });

            let myOptions = [
                {
                    label: "Analysis",
                    value: "analysis",
                    alias: "analysis",
                },
                {
                    label: "System Design",
                    value: "sys_design",
                    alias: "system design",
                },
                {
                    label: "Coding",
                    value: "coding",
                    alias: "coding",
                },
                {
                    label: "Testing",
                    value: "testing",
                    alias: "testing",
                },
                {
                    label: "Deploy",
                    value: "deploy",
                    alias: "deploy",
                },
                {
                    label: "Maintenance",
                    value: "maintenance",
                    alias: "maintenance",
                },
                {
                    label: "Document",
                    value: "document",
                    alias: "document",
                },
            ];

            let sysSelect = VirtualSelect.init({
                ele: "#systemOutlines",
                options: myOptions,
                multiple: true,
                search: true,
                searchByStartsWith: false,
                popupPosition: null,
                maxWidth: "100%",
            });

            $(".circle-progress").each(function () {
                const minValue = $(this).attr("data-min-value");
                const maxValue = $(this).attr("data-max-value");
                const value = $(this).attr("data-value");
                const type = $(this).attr("data-type");

                if (value < 40) {
                    this.classList.add("circle-progress-secondary");
                } else if (value < 70) {
                    this.classList.add("circle-progress-primary");
                } else if (value > 69) {
                    this.classList.add("circle-progress-success");
                }

                if (this.id !== "" && this.id !== null) {
                    new CircleProgress("#" + this.id, {
                        min: minValue,
                        max: maxValue,
                        value: value,
                        textFormat: type,
                    });
                }
            });

            //list project end
        </script>


    </head>

    <body>
        <div class="container-fluid position-relative bg-white d-flex p-0">
            <!-- Spinner Start -->
            <div
                id="spinner"
                class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center"
            >
                <div
                    class="spinner-border text-primary"
                    style="width: 3rem; height: 3rem"
                    role="status"
                >
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
            <!-- Spinner End -->

            <div th:replace="~{fragments/sidebar :: sidebar}"></div>

            <!-- Content Start -->
            <div
                class="content"
                style="
                    background-color: #e5e5f7;
                    opacity: 1;
                    background-image: radial-gradient(
                        #444cf7 0.6000000000000001px,
                        #e5e5f7 0.6000000000000001px
                    );
                    background-size: 12px 12px;
                "
            >
                <div
                    th:replace="~{fragments/navigation :: navigation-without-search}"
                ></div>
                <!-- Search Start -->
                <div
                    class="container-fluid pt-2 ps-s pe-2"
                    id="dropdrown-search-bar"
                >
                    <div class="d-flex flex-row justify-content-end gap-2">
                        <button class="btn btn-info" id="reset-btn">
                            reset
                        </button>
                        <div class="d-inline-block">
                            <select
                                id="month-filter"
                                class="form-control"
                                action="filter"
                            >
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="Match">Match</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="Auguest">Auguest</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                        <div class="d-inline-block">
                            <select
                                id="department-filter"
                                class="form-control"
                            ></select>
                        </div>
                        <div class="d-inline-block">
                            <select
                                id="year-filter"
                                class="form-control"
                                action="filter"
                            >
                                <option value="2011">2011</option>
                                <option value="2012">2012</option>
                                <option value="2013">2013</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                <option value="2019">2019</option>
                                <option value="2020">2020</option>
                                <option value="2021">2021</option>
                                <option value="2022">2022</option>
                                <option value="2023" selected>2023</option>
                            </select>
                        </div>

                        <form class="d-inline-block">
                            <input
                                class="form-control border-0"
                                type="search"
                                placeholder="Search project "
                            />
                        </form>
                        <!-- modal toggle button start -->
                        <button
                            type="button"
                            class="btn btn-light align-self-start d-none"
                            data-bs-toggle="modal"
                            data-bs-target="#add-department-modal"
                        >
                            <i class="bi bi-plus-lg"></i>
                        </button>
                        <!-- modal toggle button end -->
                        <!-- add department modal start -->

                        <!-- add department modal end -->
                        <!-- sortting button -->
                        <i class="bi bi-sort-alpha-down sort-btn text-dark"></i>

                        <!-- Modal -->
                    </div>
                </div>
                <!-- Search End -->

                <!-- project start -->
                <div
                    id="grid"
                    class="item-content animate__animated animate__fadeIn active"
                    data-toggle-extra="tab-content"
                >
                    <div
                        class="row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-lg-2 row-cols-xl-3"
                        id="sort-container"
                        style="margin: 10px"
                    >
                        <!-- TODO :: SHOW ALL PROJECTS LIST START FROM HERE -->

                        <!-- TODO :: SHOW ALL PROJECTS LIST END HERE -->
                    </div>
                </div>
                <!-- project end -->
            </div>
            <!-- Content End -->
        </div>

        <!--    modal for add project-->
        <div
            class="modal fade"
            id="add-department-modal"
            data-bs-keyboard="false"
            tabindex="-1"
            aria-labelledby="staticBackdropLabel"
            aria-hidden="true"
        >
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content task-content">
                    <div class="modal-header">
                        <h2 class="modal-title fs-5" style="text-align: center">
                            Add Project
                        </h2>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                        ></button>
                    </div>
                    <!-- Bordered Tabs -->
                    <nav>
                        <ul class="nav nav-tabs">
                            <li class="nav-item">
                                <a
                                    class="nav-link active"
                                    data-bs-toggle="tab"
                                    data-bs-target="#project-create"
                                    >Project</a
                                >
                            </li>

                            <li class="nav-item">
                                <a
                                    class="nav-link"
                                    data-bs-toggle="tab"
                                    data-bs-target="#client-create"
                                    >Client</a
                                >
                            </li>
                        </ul>
                    </nav>

                    <div class="tab-content pt-2">
                        <div
                            class="tab-pane fade show active"
                            id="project-create"
                        >
                            <div class="modal-body">
                                <!--                        project add-->
                                <form class="row g-3" id="validation-form">
                                    <div class="col-lg-6">
                                        <!--                                name input-->
                                        <label
                                            for="name"
                                            class="col-sm-12 col-form-label"
                                            name="name"
                                            >Project Name<span
                                                style="color: #dec6c6"
                                            >
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="text"
                                            class="form-control border-task-description"
                                            id="name"
                                            name="name"
                                        />
                                    </div>

                                    <!--                            client add-->
                                    <div class="col-lg-6">
                                        <label
                                            for="client"
                                            class="col-sm-12 col-form-label"
                                            name="client"
                                            >Client<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <select
                                            class="form-select"
                                            id="client"
                                            name="client"
                                        ></select>
                                    </div>

                                    <!--                            start date add-->
                                    <div class="col-md-6">
                                        <label
                                            for="start_date"
                                            class="col-sm-12 col-form-label"
                                            name="start_date"
                                            >Start Date<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="date"
                                            class="form-control border-task-description"
                                            id="start_date"
                                            name="start_date"
                                        />
                                    </div>

                                    <!--                                end date add-->
                                    <div class="col-md-6">
                                        <label
                                            for="project-add-duration"
                                            class="col-sm-12 col-form-label"
                                            >Enter Duration (Month)<span
                                                style="color: red"
                                            >
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="number"
                                            class="form-control border-task-description"
                                            id="project-add-duration"
                                            min="1"
                                            value="1"
                                            required
                                            oninput="validity.valid||(value='');"
                                        />
                                    </div>

                                    <div class="col-md-6">
                                        <label
                                            for="project-add-duration"
                                            class="col-sm-12 col-form-label"
                                            >End date<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="text"
                                            disabled
                                            id="project-add-end-date"
                                            class="form-control"
                                        />
                                    </div>

                                    <!--                                background add-->
                                    <div class="col-lg-6">
                                        <label
                                            for="background"
                                            class="col-sm-12 col-form-label"
                                            name="background"
                                            >Background<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <textarea
                                            type="text"
                                            class="form-control border-task-description"
                                            id="background"
                                            name="background"
                                            required
                                        ></textarea>
                                    </div>

                                    <!--                                architectures add-->
                                    <div class="col-lg-6">
                                        <label
                                            for="architectures"
                                            class="col-sm-12 col-form-label"
                                            name="architectures"
                                            >Architecture<span
                                                style="color: red"
                                            >
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="text"
                                            class="form-control"
                                            id="architectures"
                                            name="architectures"
                                            placeholder="enter to add your own architecture"
                                            required
                                        />
                                    </div>

                                    <!--                                systemoutline add-->
                                    <div class="col-lg-6">
                                        <label
                                            for="systemOutlines"
                                            class="col-sm-12 col-form-label"
                                            name="systemOutlines"
                                            >System Outlines
                                            <span style="color: red"> *</span>
                                        </label>
                                        <div id="systemOutlines"></div>
                                    </div>

                                    <div class="col-lg-6">
                                        <label
                                            for="employee-list"
                                            class="col-sm-12 col-form-label"
                                            name="systemOutlines"
                                            >Choose employee
                                            <span style="color: red"> *</span>
                                        </label>
                                        <div id="employee-list"></div>
                                    </div>

                                    <!--                                deliverable add-->
                                    <div class="col-lg-6">
                                        <label
                                            for="deliverable"
                                            class="col-sm-12 col-form-label"
                                            name="deliverable"
                                            >Deliverable<span
                                                style="color: red"
                                            >
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="text"
                                            class="form-control"
                                            id="deliverable"
                                            name="enter to add your own deliverable type"
                                            placeholder="add value"
                                            required
                                        />
                                    </div>

                                    <div
                                        class="col-lg-12"
                                        style="margin-bottom: 80px"
                                    >
                                        <label for="objective"
                                            >Objective<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <div
                                            class="quill-editor-full"
                                            id="objective"
                                            name="objective"
                                        ></div>
                                    </div>

                                    <div class="text-center">
                                        <button
                                            type="submit"
                                            class="btn btn-primary col-2"
                                            data-dismiss="modal"
                                        >
                                            Add
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!--                project add form end-->

                        <div class="tab-pane fade" id="client-create">
                            <div class="modal-body modal-lg-6">
                                <form class="row g-4" id="client-form">
                                    <div class="col-md-12">
                                        <label
                                            for="client-name"
                                            class="col-sm-12 col-form-label"
                                            >Client Name<span
                                                style="color: red"
                                            >
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="text"
                                            class="form-control border-task-description"
                                            id="client-name"
                                            name="name"
                                            required
                                        />
                                    </div>

                                    <div class="col-md-12">
                                        <label
                                            for="client-email"
                                            class="col-sm-12 col-form-label"
                                            >Email<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="email"
                                            class="form-control border-task-description"
                                            id="client-email"
                                            name="email"
                                            required
                                        />
                                    </div>

                                    <div class="col-md-12">
                                        <label
                                            for="client-phone"
                                            class="col-sm-12 col-form-label"
                                            >Phone<span style="color: red">
                                                *</span
                                            ></label
                                        >
                                        <input
                                            type="phone"
                                            class="form-control border-task-description"
                                            id="client-phone"
                                            name="phone"
                                            parttern="[0-9]{10}"
                                        />
                                    </div>

                                    <div class="text-center">
                                        <button
                                            type="submit"
                                            class="btn btn-primary mr-3"
                                            data-dismiss="modal"
                                        >
                                            Create
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--    modal for add project-->

        <!-- modal for project's details -->
        <div class="modal fade" id="project-details" data-bs-keyboard="true">
            <div class="modal-dialog modal-dialog-centered modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">
                            Department Details
                        </h5>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                        ></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-xl-4">
                                <div class="card">
                                    <div
                                        class="card-body profile-card pt-4 d-flex flex-column align-items-center"
                                    >
                                        <img
                                            src="/images/avatars/pm_avatar.svg"
                                            alt="Profile"
                                            class="rounded-circle"
                                        />
                                        <h4>Kevin Anderson</h4>
                                        <div class="social-links mt-2">
                                            <h5>Project Manager</h5>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-8">
                                <div class="card">
                                    <div class="card-body pt-3">
                                        <!-- Bordered Tabs -->
                                        <ul
                                            class="nav nav-tabs nav-tabs-bordered"
                                        >
                                            <li class="nav-item">
                                                <button
                                                    class="nav-link active"
                                                    data-bs-toggle="tab"
                                                    data-bs-target="#project-overview"
                                                >
                                                    Overview
                                                </button>
                                            </li>

                                            <li class="nav-item">
                                                <button
                                                    class="nav-link"
                                                    data-bs-toggle="tab"
                                                    data-bs-target="#project-edit"
                                                >
                                                    Edit
                                                </button>
                                            </li>
                                            <li class="nav-item">
                                                <button
                                                    class="nav-link"
                                                    data-bs-toggle="tab"
                                                    data-bs-target="#client-info"
                                                >
                                                    Client info
                                                </button>
                                            </li>

                                            <li class="nav-item">
                                                <button
                                                    class="nav-link"
                                                    data-bs-toggle="tab"
                                                    data-bs-target="#amount"
                                                >
                                                    Amount
                                                </button>
                                            </li>

                                            <li class="nav-item">
                                                <button
                                                        class="nav-link"
                                                        data-bs-toggle="tab"
                                                        data-bs-target="#deliverable-list"
                                                >
                                                    deliverable
                                                </button>
                                            </li>

                                            <li class="nav-item">
                                                <button
                                                        class="nav-link"
                                                        data-bs-toggle="tab"
                                                        data-bs-target="#edit-architecture"
                                                >
                                                    architecture
                                                </button>
                                            </li>

                                            <li class="nav-item">
                                                <button
                                                    class="nav-link"
                                                    data-bs-toggle="tab"
                                                    data-bs-target="#review"
                                                >
                                                    Review
                                                </button>
                                            </li>
                                        </ul>
                                        <div class="tab-content pt-2">
                                            <div
                                                class="tab-pane fade show active profile-overview"
                                                id="project-overview"
                                            >
                                                <h5 class="card-title">
                                                    About background
                                                </h5>
                                                <p
                                                    class="small fst-italic"
                                                    id="project-background"
                                                ></p>

                                                <h5 class="card-title">
                                                    Project Details
                                                </h5>

                                                <div class="row">
                                                    <div
                                                        class="col-lg-3 col-md-4 label col-4"
                                                    >
                                                        Department name
                                                    </div>
                                                    <div
                                                        class="col-lg-9 col-md-8 col-8"
                                                        id="project-department-name"
                                                    >
                                                        dance club
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div
                                                        class="col-lg-3 col-md-4 label col-4"
                                                    >
                                                        Project name
                                                    </div>
                                                    <div
                                                        class="col-lg-9 col-md-8 col-8"
                                                        id="project-name"
                                                    >
                                                        find nemo
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div
                                                        class="col-lg-3 col-md-4 label col-4"
                                                    >
                                                        Duration
                                                    </div>
                                                    <div
                                                        class="col-lg-9 col-md-8 col-8"
                                                        id="project-duration"
                                                    >
                                                        3 Months
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div
                                                        class="col-lg-3 col-md-4 label col-4"
                                                    >
                                                        Start date
                                                    </div>
                                                    <div
                                                        class="col-lg-9 col-md-8 col-8"
                                                        id="project-start-date"
                                                    >
                                                        25 september 2022
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div
                                                        class="col-lg-3 col-md-4 label col-4"
                                                    >
                                                        End date
                                                    </div>
                                                    <div
                                                        class="col-lg-9 col-md-8 col-8"
                                                        id="project-end-date"
                                                    >
                                                        25 december 2022
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div
                                                        class="col-lg-3 col-md-4 label col-4"
                                                    >
                                                        Current phase
                                                    </div>
                                                    <div
                                                        class="col-lg-9 col-md-8 col-8"
                                                        id="project-current-phase"
                                                    >
                                                        Basic design
                                                    </div>
                                                </div>
                                                <div
                                                    class="accordion"
                                                    id="accordionExample"
                                                >
                                                    <div class="accordion-item">
                                                        <h2
                                                            class="accordion-header"
                                                            id="headingOne"
                                                        >
                                                            <button
                                                                class="accordion-button collapsed"
                                                                type="button"
                                                                data-bs-toggle="collapse"
                                                                data-bs-target="#collapseOne"
                                                                aria-expanded="false"
                                                                aria-controls="collapseOne"
                                                            >
                                                                System Outline
                                                            </button>
                                                        </h2>
                                                        <div
                                                            id="collapseOne"
                                                            class="accordion-collapse collapse"
                                                            aria-labelledby="headingOne"
                                                            data-bs-parent="#accordionExample"
                                                        >
                                                            <ul
                                                                class="list-group accordion-body p-2 rounded-end"
                                                            >
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    Analysis<i
                                                                        class="bi bi-check2-all text-success fs-4"
                                                                    ></i>
                                                                </li>
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    System
                                                                    Design<i
                                                                        class="bi bi-check2-all text-success fs-4"
                                                                    ></i>
                                                                </li>
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    Source
                                                                    Code<i
                                                                        class="bi bi-check2-all text-success fs-4"
                                                                    ></i>
                                                                </li>
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    Testing<i
                                                                        class="bi bi-check2-all text-success fs-4"
                                                                    ></i>
                                                                </li>
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    Deploy
                                                                </li>
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    Maintence
                                                                </li>
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between"
                                                                >
                                                                    Document
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="accordion-item">
                                                        <h2
                                                            class="accordion-header"
                                                            id="headingTwo"
                                                        >
                                                            <button
                                                                class="accordion-button collapsed"
                                                                type="button"
                                                                data-bs-toggle="collapse"
                                                                data-bs-target="#collapseTwo"
                                                                aria-expanded="false"
                                                                aria-controls="collapseTwo"
                                                            >
                                                                Amount
                                                            </button>
                                                        </h2>
                                                        <div
                                                            id="collapseTwo"
                                                            class="accordion-collapse collapse"
                                                            aria-labelledby="headingTwo"
                                                            data-bs-parent="#accordionExample"
                                                        >
                                                            <ul
                                                                class="list-group accordion-body p-2 rounded-end"
                                                            >
                                                                <li
                                                                    class="list-group-item d-flex justify-content-between align-items-center"
                                                                >
                                                                    Basic
                                                                    Design<span
                                                                        class="badge bg-primary rounded-pill"
                                                                        id="basic-design-count"
                                                                        ></span
                                                                    >
                                                                </li>

                                                                <li
                                                                    class="list-group-item d-flex justify-content-between align-items-center"
                                                                >
                                                                    Detail
                                                                    Design<span
                                                                        class="badge bg-primary rounded-pill"
                                                                        id="detail-design-count"
                                                                        ></span
                                                                    >
                                                                </li>

                                                                <li
                                                                    class="list-group-item d-flex justify-content-between align-items-center"
                                                                >
                                                                    Coding<span
                                                                        class="badge bg-primary rounded-pill"
                                                                        id="coding-count"
                                                                        ></span
                                                                    >
                                                                </li>

                                                                <li
                                                                    class="list-group-item d-flex justify-content-between align-items-center"
                                                                >
                                                                    Unit
                                                                    Testing<span
                                                                        class="badge bg-primary rounded-pill"
                                                                        id="unit-testing-count"
                                                                        ></span
                                                                    >
                                                                </li>

                                                                <li
                                                                    class="list-group-item d-flex justify-content-between align-items-center"
                                                                >
                                                                    Integrated
                                                                    Testing<span
                                                                        class="badge bg-primary rounded-pill"
                                                                        id="integrated-testing-count"
                                                                        ></span
                                                                    >
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="accordion-item">
                                                        <h2
                                                            class="accordion-header"
                                                            id="headingThree"
                                                        >
                                                            <button
                                                                class="accordion-button collapsed"
                                                                type="button"
                                                                data-bs-toggle="collapse"
                                                                data-bs-target="#collapseThree"
                                                                aria-expanded="false"
                                                                aria-controls="collapseThree"
                                                            >
                                                                Objective
                                                            </button>
                                                        </h2>
                                                        <div
                                                            id="collapseThree"
                                                            class="accordion-collapse collapse"
                                                            aria-labelledby="headingThree"
                                                            data-bs-parent="#accordionExample"
                                                        >
                                                            <div
                                                                class="accordion-body position-relative"
                                                                id="show-project-objective"
                                                            ></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div
                                                class="tab-pane fade profile-edit pt-3"
                                                id="project-edit"
                                            >
                                                <!-- Profile Edit Form -->
                                                <form id="project-detail-edit-form">
                                                    <input type="number" hidden id="current-edditing-projetc-id">
                                                    <div class="row mb-3">
                                                        <label
                                                            for="edit-project-phase"
                                                            class="col-md-4 col-lg-3 col-form-label"
                                                            >Current
                                                            Phase</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            
                                                                <select
                                                                    type="text"
                                                                    class="form-control border-task-description"
                                                                    name=""
                                                                    id="edit-project-phase"
                                                                >
                                                                <option
                                                                    value="PLANNING"
                                                                >
                                                                    Planning
                                                                </option>
                                                                <option
                                                                value="DESIGN"
                                                                >
                                                                    Design
                                                                </option>
                                                                <option
                                                                    value="CODING"
                                                                >
                                                                    Coding
                                                                </option>
                                                                <option
                                                                value="TESTING"
                                                                >
                                                                    Testing
                                                                </option>
                                                                <option
                                                                    value="REVIEW"
                                                                >
                                                                    Review
                                                                </option>
                                                                <option
                                                                    value="DEPLOYMENT"
                                                                >
                                                                    Deployment
                                                                </option>
                                                                <option
                                                                    value="MAINTENANCE"
                                                                >
                                                                    Maintenance
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-3">
                                                        <label
                                                            for="background"
                                                            class="colmd-4 col-lg-3 col-form-label"
                                                            >Background</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            <textarea
                                                                type="text"
                                                                class="form-control border-task-description"
                                                                name="background"
                                                                id="project-detail-background"
                                                                required
                                                            ></textarea>
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label
                                                            for="project-detail-name"
                                                            class="col-md-4 col-lg-3 col-form-label"
                                                            >Project name</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            <input
                                                                name="project_name"
                                                                type="text"
                                                                class="form-control"
                                                                id="project-detail-name"
                                                                required
                                                            />
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label
                                                            for="start-date"
                                                            class="col-md-4 col-lg-3 col-form-label"
                                                            >start date</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            <input
                                                                name="start_date"
                                                                type="date"
                                                                class="form-control"
                                                                id="start-date"
                                                                required
                                                            />
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label
                                                            for="project-edit-duration"
                                                            class="col-md-4 col-lg-3 col-form-label"
                                                            >Duration</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            <input
                                                                name="end_date"
                                                                type="number"
                                                                min="1"
                                                                value="1"
                                                                required
                                                                class="form-control"
                                                                id="project-edit-duration"
                                                                oninput="validity.valid||(value='');"
                                                            />
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label
                                                            for="end-date-in-edit"
                                                            class="col-md-4 col-lg-3 col-form-label"
                                                            >end date</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            <input
                                                                name="start_date"
                                                                type="text"
                                                                class="form-control"
                                                                id="end-date-in-edit"
                                                                disabled
                                                            />
                                                        </div>
                                                    </div>

                                                    <div class="row mb-3">
                                                        <label
                                                            for="objective"
                                                            class="col-md-4 col-lg-3 col-form-label"
                                                            >Objective</label
                                                        >
                                                        <div
                                                            class="col-md-8 col-lg-9"
                                                        >
                                                            <div
                                                                id="edit-project-objective"
                                                            ></div>
                                                        </div>
                                                    </div>

                                                    <div
                                                        class="text-center mt-5"
                                                    >
                                                        <button
                                                            type="submit"
                                                            class="btn btn-primary"
                                                        >
                                                            Save Changes
                                                        </button>
                                                    </div>
                                                </form>
                                                <!-- End Profile Edit Form -->
                                            </div>
                                            <div
                                                class="tab-pane fade profile-edit pt-3"
                                                id="client-info"
                                            >
                                                <div class="row">
                                                    <div
                                                        class="fs-2 text-center"
                                                        id="my-dear-customer-name"
                                                    >
                                                        DAT
                                                    </div>
                                                    <div
                                                        class="row row-cols-1 gap-2"
                                                    >
                                                        <div
                                                            class="d-flex justify-content-start align-items-center gap-2"
                                                        >
                                                            <div
                                                                class="p-2 d-inline-block justify-content-center align-items-center rounded-circle bg-primary fs-5 text-white"
                                                            >
                                                                <i
                                                                    class="bi bi-envelope-at"
                                                                ></i>
                                                            </div>
                                                            <div
                                                                class="align-self-center"
                                                                id="client-email-address"
                                                            >
                                                                suckmyfingure@gmail.com
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="d-flex justify-content-start align-items-center gap-2"
                                                        >
                                                            <div
                                                                class="p-2 d-inline-block justify-content-center align-items-center rounded-circle bg-primary fs-5 text-white"
                                                            >
                                                                <i
                                                                    class="bi bi-telephone"
                                                                ></i>
                                                            </div>
                                                            <div
                                                                class="align-self-center"
                                                                id="client-phone-contect"
                                                            >
                                                                09 77558822
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div
                                                class="tab-pane fade pt-3"
                                                id="amount"
                                            >
                                                <ul
                                                    class="list-group accordion-body p-2 rounded-end"
                                                >
                                                    <li
                                                        class="list-group-item d-flex justify-content-between"
                                                    >
                                                        Basic design
                                                        <div class="number">
                                                            <span class="minus"
                                                                >-</span
                                                            >
                                                            <input
                                                                type="text"
                                                                value="0"
                                                                id="edit-basic-design-count"
                                                            />
                                                            <span class="plus"
                                                                >+</span
                                                            >
                                                        </div>
                                                    </li>
                                                    <li
                                                        class="list-group-item d-flex justify-content-between"
                                                    >
                                                        Detail design
                                                        <div class="number">
                                                            <span class="minus"
                                                                >-</span
                                                            >
                                                            <input
                                                                type="text"
                                                                value="0"
                                                                id="edit-detail-design-count"
                                                            />
                                                            <span class="plus"
                                                                >+</span
                                                            >
                                                        </div>
                                                    </li>
                                                    <li
                                                        class="list-group-item d-flex justify-content-between"
                                                    >
                                                        Coding
                                                        <div class="number">
                                                            <span class="minus"
                                                                >-</span
                                                            >
                                                            <input
                                                                type="text"
                                                                value="0"
                                                                id="edit-coding-count"
                                                            />
                                                            <span class="plus"
                                                                >+</span
                                                            >
                                                        </div>
                                                    </li>
                                                    <li
                                                        class="list-group-item d-flex justify-content-between"
                                                    >
                                                        Unit testing
                                                        <div class="number">
                                                            <span class="minus"
                                                                >-</span
                                                            >
                                                            <input
                                                                type="text"
                                                                value="0"
                                                                id="edit-unit-testing-count"
                                                            />
                                                            <span class="plus"
                                                                >+</span
                                                            >
                                                        </div>
                                                    </li>
                                                    <li
                                                        class="list-group-item d-flex justify-content-between"
                                                    >
                                                        Integrated testing
                                                        <div class="number">
                                                            <span class="minus"
                                                                >-</span
                                                            >
                                                            <input
                                                                type="text"
                                                                value="0"
                                                                id="edit-integrated-testing-count"
                                                            />
                                                            <span class="plus"
                                                                >+</span
                                                            >
                                                        </div>
                                                    </li>
                                                </ul>
                                                <div class="text-center">
                                                    <button
                                                        class="btn btn-primary"
                                                        style="
                                                            background-color: #369;
                                                        "
                                                        id="update-amount-btn"
                                                        >Save Amount</button
                                                    >
                                                </div>
                                            </div>

                                            <div class="tab-pane fade profile-edit pt-3" id="review">
                                                <div class="row mb-3">
                                                    <label for="project-internal-review-count"
                                                            class="col-md-4 col-lg-3 col-form-label">External Review</label>
                                                    <div class="col-md-8 col-lg-9">
                                                        <input
                                                                name="project_name"
                                                                type="number"
                                                                class="form-control"
                                                                id="project-internal-review-count"/>
                                                    </div>
                                                </div>

                                                <div class="row mb-3">
                                                    <label for="project-external-review-count"
                                                           class="col-md-4 col-lg-3 col-form-label">Internal Review</label>
                                                    <div class="col-md-8 col-lg-9">
                                                        <input
                                                                name="project_name"
                                                                type="number"
                                                                class="form-control"
                                                                id="project-external-review-count"/>
                                                    </div>
                                                </div>
                                            </div>

                                            <div
                                                    class="tab-pane fade pt-3"
                                                    id="edit-architecture"
                                            >

                                                <div id="architectures-list-in-edit" class="d-flex gap-2">

                                                </div>
                                            </div>
                                            <div class="tab-pane fade pt-3" id="deliverable-list">
                                                <form id="deliverable-type-form">
                                                    <div id="deliverable-type">
                                                        <!-- Checkbox elements will be dynamically added here -->
                                                    </div>
                                                    <button type="submit">Submit</button>
                                                </form>

                                            </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="/project" class="btn btn-primary" id="navigate-task"
                            >manage task</a
                        >
                    </div>
                </div>
            </div>
        </div>
        <!-- modal for project's details -->

        <!-- Scripts -->

        <!-- fontawesome -->

        <!-- sort (department, project), form validation and search bar behavior are all here -->

        <!-- <script src="/js/bootstrap-select2.min.js"></script> -->
        <!-- <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0/js/bootstrap-select.min.js"></script> -->
    </body>
</html>
